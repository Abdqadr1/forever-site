{"ast":null,"code":"import _toConsumableArray from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/HP/Desktop/Programs/forever-site/client/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'../styles/orders.css';import Order from'./order';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Orders=/*#__PURE__*/function(_Component){_inherits(Orders,_Component);var _super=_createSuper(Orders);function Orders(){var _this;_classCallCheck(this,Orders);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={views:0,entries:0,filter:1,orders:[],all:[],trash:[],active:[],search:\"\",isFiltered:false,unread:0,page:1};_this.entriesByPage=20;_this.handleChange=function(event){_this.setState(_defineProperty({},event.target.name,event.target.value));};_this.handleSubmit=function(ev){ev.preventDefault();var text=_this.state.search.toLowerCase().trim();if(text&&text!==\"\"){var result=_this.state.orders.filter(function(order){if(order.name.toLowerCase().includes(text))return true;if(order.address.toLowerCase().includes(text))return true;if(order.phone.toLowerCase().includes(text))return true;if(order.date.toLowerCase().includes(text))return true;return false;}).concat(_this.state.trash.filter(function(order){if(order.name.toLowerCase().includes(text))return true;if(order.address.toLowerCase().includes(text))return true;if(order.phone.toLowerCase().includes(text))return true;if(order.date.toLowerCase().includes(text))return true;return false;}));_this.setState({isFiltered:true,orders:result,active:result,filter:0});}};_this.callApi=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('/api/orders');case 2:response=_context.sent;_context.next=5;return response.json();case 5:body=_context.sent;if(!(response.status!==200)){_context.next=8;break;}throw Error(body.message);case 8:return _context.abrupt(\"return\",body);case 9:case\"end\":return _context.stop();}}},_callee);}));_this.trash=function(Id){var id=Number(Id);console.log(\"deleted \",id);var all=_this.state.all;var trash=_this.state.trash;var index=all.findIndex(function(each){return each.id===id;});trash.unshift(all[index]);all=all.filter(function(order){return order.id!==id;});var unread=all.filter(function(order){return order.read===false;}).length;console.log(unread);_this.setState({entries:all.length,all:all,unread:unread,orders:all,trash:trash,active:all});};_this.delete=function(id){console.log(\"deleted \",id);var trash=_this.state.trash;trash=trash.filter(function(order){return order.id!==id;});_this.setState({trash:trash,orders:trash,active:trash});};_this.toggleRead=function(id){var all=_this.state.all;var filter=_this.state.filter;var number=_this.state.page;var unread=_this.state.unread;all=all.filter(function(order){if(order.id===id){order.read=!order.read;}return true;});var orders;if(filter===1){orders=all;unread=all.filter(function(order){return order.read===false;}).length;}if(filter===2){orders=all.filter(function(order){return order.read===false;});unread=orders.length;}var pageNo=Math.ceil(orders.length/_this.entriesByPage);number=number>pageNo?number-1:number;if(number===1){_this.setState({orders:orders.slice(0,_this.entriesByPage),page:1,all:all,active:orders,unread:unread});return;}else{var start=_this.entriesByPage*(number-1);var entries=_toConsumableArray(orders);var order=start+_this.entriesByPage>entries.length?entries.splice(start):entries.splice(start,_this.entriesByPage);_this.setState({orders:order,page:number,all:all,active:orders,unread:unread});}};_this.restore=function(id){var all=_this.state.all;var trash=_this.state.trash;var index=trash.findIndex(function(order){return order.id===id;});all.unshift(trash[index]);trash=trash.filter(function(order){return order.id!==id;});_this.setState({entries:all.length,all:all,orders:trash,trash:trash,active:trash});};_this.filter=function(event){var val=event.target.outerText.toLowerCase();if(val.includes(\"all\")&&_this.state.filter!==1){var orders=_toConsumableArray(_this.state.all);_this.setState({filter:1,orders:orders.splice(0,_this.entriesByPage),active:_this.state.all,page:1});}if(val.includes(\"unread\")&&_this.state.filter!==2){var all=_this.state.all.filter(function(order){return order.read===false;});var _orders=_toConsumableArray(all);_this.setState({filter:2,orders:_orders.splice(0,_this.entriesByPage),active:all,page:1});}if(val.includes(\"trash\")&&_this.state.filter!==3){var _orders2=_toConsumableArray(_this.state.trash);_this.setState({filter:3,orders:_orders2.splice(0,_this.entriesByPage),active:_this.state.trash,page:1});}};_this.reset=function(e){var c=window.confirm(\"This action cannot be undone, Are you sure?\");if(c){var val=e.target.outerText.toLowerCase();if(val.includes(\"views\")){fetch('/orders/reset/views',{method:\"put\",headers:{'Content-Type':'application/json'}}).then(function(res){return res.json();}).then(function(data){console.log(data);_this.setState({views:0});}).catch(function(err){return console.log(err);});}if(val.includes(\"entries\")){fetch('/orders/reset/entries',{method:\"put\",headers:{'Content-Type':'application/json'}}).then(function(res){return res.json();}).then(function(data){console.log(data);_this.setState({entries:0,orders:[],all:[],trash:[],active:[]});}).catch(function(err){return console.log(err);});}}};_this.handlePaging=function(e){var number=Number(e.target.innerText);if(number!==_this.state.page){var orders=_toConsumableArray(_this.state.active);if(number===1){_this.setState({orders:orders.slice(0,_this.entriesByPage),page:1});return;}else{var start=_this.entriesByPage*(number-1);var order=start+_this.entriesByPage>orders.length?orders.splice(start):orders.splice(start,_this.entriesByPage);_this.setState({orders:order,page:number});}}};return _this;}_createClass(Orders,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.callApi().then(function(data){var num=data.orders.orders.filter(function(order){return order.read===false;}).length;var orders=_toConsumableArray(data.orders.orders);_this2.setState({entries:data.orders.orders.length,orders:orders.splice(0,_this2.entriesByPage),all:data.orders.orders,trash:data.trash.orders,views:data.trash.views,unread:num,active:data.orders.orders});}).catch(function(err){return console.log(err);});}},{key:\"render\",value:function render(){var _this3=this;var orders=!this.state.orders.length?/*#__PURE__*/_jsx(\"p\",{className:\"no-orders red-text\",children:this.state.isFiltered?\"No Order Found\":\"No Orders Yet\"}):this.state.orders.map(function(order,index){var className=index%2===0?\"classone\":\"classtwo\";return/*#__PURE__*/_jsx(Order,{order:order,delete:_this3.delete,trash:_this3.trash,class:className,filter:_this3.state.filter,toggleRead:_this3.toggleRead,restore:_this3.restore},order.id);});var pageNo=Math.ceil(this.state.active.length/this.entriesByPage);var pages=[];for(var x=1;x<=pageNo;x++){var active=x===this.state.page?\" active\":\" inactive\";var html=/*#__PURE__*/_jsx(\"span\",{className:\"page\"+active,onClick:this.handlePaging,children:x.toString()},x);pages.push(html);}return/*#__PURE__*/_jsxs(\"div\",{className:\"admins\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Views: \",this.state.views,/*#__PURE__*/_jsx(\"i\",{onClick:this.reset,children:\"reset views\"})]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Entries: \",this.state.entries,/*#__PURE__*/_jsx(\"i\",{onClick:this.reset,children:\"reset entries\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-form\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"search\",placeholder:\"search text\",onChange:this.handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Search\",onClick:this.handleSubmit})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter\",children:[/*#__PURE__*/_jsxs(\"span\",{onClick:this.filter,className:this.state.filter===1?\"active\":\"inactive\",children:[\"All\",/*#__PURE__*/_jsx(\"i\",{children:this.state.all.length})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:this.filter,className:this.state.filter===2?\"active\":\"inactive\",children:[\"Unread\",/*#__PURE__*/_jsx(\"i\",{children:this.state.unread})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:this.filter,className:this.state.filter===3?\"active\":\"inactive\",children:[\"Trash\",/*#__PURE__*/_jsx(\"i\",{children:this.state.trash.length})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"orders\",children:orders}),this.state.active.length>this.entriesByPage?/*#__PURE__*/_jsx(\"div\",{className:\"paging\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pages\",children:pages})}):\"\"]});}}]);return Orders;}(Component);export default Orders;","map":{"version":3,"sources":["C:/Users/HP/Desktop/Programs/forever-site/client/src/components/orders.js"],"names":["React","Component","Order","Orders","state","views","entries","filter","orders","all","trash","active","search","isFiltered","unread","page","entriesByPage","handleChange","event","setState","target","name","value","handleSubmit","ev","preventDefault","text","toLowerCase","trim","result","order","includes","address","phone","date","concat","callApi","fetch","response","json","body","status","Error","message","Id","id","Number","console","log","index","findIndex","each","unshift","read","length","delete","toggleRead","number","pageNo","Math","ceil","slice","start","splice","restore","val","outerText","reset","e","c","window","confirm","method","headers","then","res","data","catch","err","handlePaging","innerText","num","map","className","pages","x","html","toString","push"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport '../styles/orders.css';\r\nimport Order from './order';\r\n\r\n\r\nclass Orders extends Component {\r\n    state = { views: 0, entries: 0, filter: 1,\r\n        orders: [],\r\n          all: [],\r\n          trash: [],\r\n          active: [],\r\n          search: \"\",\r\n          isFiltered: false,\r\n          unread: 0,\r\n          page: 1,\r\n    }\r\n    entriesByPage = 20\r\n\r\n    handleChange = (event) => {\r\n        this.setState({\r\n            [event.target.name]: event.target.value\r\n        })\r\n    }\r\n\r\n    handleSubmit = (ev) => {\r\n        ev.preventDefault();\r\n        const text = this.state.search.toLowerCase().trim();\r\n        if(text && text !== \"\"){\r\n            const result = this.state.orders.filter(order => {\r\n                if(order.name.toLowerCase().includes(text)) return true;\r\n                if(order.address.toLowerCase().includes(text)) return true;\r\n                if(order.phone.toLowerCase().includes(text)) return true;\r\n                if(order.date.toLowerCase().includes(text)) return true;\r\n                return false;\r\n            }).concat(\r\n                this.state.trash.filter(order => {\r\n                    if(order.name.toLowerCase().includes(text)) return true;\r\n                    if(order.address.toLowerCase().includes(text)) return true;\r\n                    if(order.phone.toLowerCase().includes(text)) return true;\r\n                    if(order.date.toLowerCase().includes(text)) return true;\r\n                    return false;\r\n                })\r\n            )\r\n            this.setState({\r\n                isFiltered: true,\r\n                orders: result, \r\n                active: result,\r\n                filter: 0,\r\n            })\r\n        }\r\n       \r\n    }\r\n\r\n    componentDidMount() {\r\n      this.callApi()\r\n      .then(data => {\r\n          var num = data.orders.orders.filter(order => order.read === false).length;\r\n          var orders = [...data.orders.orders];\r\n            this.setState({\r\n                entries: data.orders.orders.length,\r\n                orders: orders.splice(0, this.entriesByPage),\r\n                all: data.orders.orders,\r\n                trash: data.trash.orders,\r\n                views: data.trash.views,\r\n                unread: num,\r\n                active: data.orders.orders,\r\n            })\r\n\r\n        })\r\n      .catch(err => console.log(err))\r\n    }\r\n\r\n    callApi = async () => {\r\n        const response = await fetch('/api/orders');\r\n        const body = await response.json();\r\n        if (response.status !== 200) throw Error(body.message);\r\n        \r\n        return body;\r\n    }\r\n\r\n    trash = (Id) => {\r\n        const id = Number(Id);\r\n        console.log(\"deleted \", id)\r\n        var all = this.state.all;\r\n        var trash = this.state.trash;\r\n        const index = all.findIndex(each => each.id === id);\r\n        trash.unshift(all[index])\r\n        all = all.filter(order => order.id !== id);\r\n        var unread = all.filter(order =>  order.read === false).length;\r\n        console.log(unread);\r\n        this.setState({\r\n            entries: all.length,\r\n            all,\r\n            unread,\r\n            orders: all,\r\n            trash,\r\n            active: all\r\n        })\r\n    }\r\n\r\n    delete = (id) => {\r\n        console.log(\"deleted \", id)\r\n        var trash = this.state.trash;\r\n        trash = trash.filter(order => order.id !== id);\r\n        this.setState({\r\n            trash,\r\n            orders: trash,\r\n            active: trash,\r\n        })\r\n    }\r\n\r\n    toggleRead = (id) => {\r\n        var all = this.state.all;\r\n        const filter = this.state.filter;\r\n        var number = this.state.page;\r\n        var unread = this.state.unread;\r\n        all = all.filter(order => {\r\n            if(order.id === id){\r\n                order.read = !order.read;\r\n            }\r\n            return true;\r\n        })\r\n        var orders;\r\n        if(filter === 1){\r\n            orders =  all;\r\n            unread = all.filter(order =>  order.read === false).length;\r\n        }\r\n        if(filter === 2) {\r\n            orders =  all.filter(order =>  order.read === false);\r\n            unread = orders.length;\r\n        }\r\n        const pageNo = Math.ceil(orders.length / this.entriesByPage);\r\n        number = number > pageNo ? number - 1: number;\r\n        if(number === 1){\r\n            this.setState({\r\n                orders: orders.slice(0, this.entriesByPage),\r\n                page: 1,\r\n                all,\r\n                active: orders,\r\n                unread\r\n            })\r\n            return;\r\n        }else{\r\n            const start = this.entriesByPage * (number - 1);\r\n            const entries = [...orders];\r\n            const order = (start + this.entriesByPage) > entries.length ? entries.splice(start) : entries.splice(start, this.entriesByPage);\r\n            this.setState({\r\n                orders: order,\r\n                page: number,\r\n                all,\r\n                active: orders,\r\n                unread\r\n            })\r\n        }\r\n    }\r\n    \r\n\r\n    restore = (id) => {\r\n        var all = this.state.all;\r\n        var trash = this.state.trash;\r\n        var index = trash.findIndex(order => order.id === id);\r\n        all.unshift(trash[index])\r\n        trash = trash.filter(order => order.id !== id);\r\n        this.setState({\r\n            entries: all.length,\r\n            all,\r\n            orders: trash,\r\n            trash,\r\n            active:trash,\r\n        })\r\n    }\r\n\r\n    filter = (event) => {\r\n        let val = event.target.outerText.toLowerCase();\r\n        if(val.includes(\"all\") && this.state.filter !== 1){\r\n            const orders = [...this.state.all]\r\n            this.setState({\r\n                filter: 1, \r\n                orders: orders.splice(0, this.entriesByPage),\r\n                 active: this.state.all,\r\n                 page: 1,\r\n            });\r\n        }\r\n\r\n        if(val.includes(\"unread\") && this.state.filter !== 2){\r\n            const all =  this.state.all.filter(order =>  order.read === false);\r\n            const orders = [...all]\r\n            this.setState({\r\n                filter: 2, \r\n                orders: orders.splice(0, this.entriesByPage),\r\n                active: all,\r\n                page: 1,\r\n            });\r\n\r\n        }\r\n        if(val.includes(\"trash\") && this.state.filter !== 3){\r\n            const orders = [...this.state.trash];\r\n            this.setState({\r\n                filter: 3, \r\n                orders:orders.splice(0, this.entriesByPage),\r\n                active: this.state.trash,\r\n                page: 1,\r\n            });\r\n            \r\n        }\r\n    }\r\n\r\n    reset = (e) => {\r\n        var c = window.confirm(\"This action cannot be undone, Are you sure?\");\r\n        if(c){\r\n            let val = e.target.outerText.toLowerCase();\r\n            if(val.includes(\"views\")) {\r\n                fetch('/orders/reset/views', {\r\n                    method: \"put\", \r\n                    headers: {'Content-Type': 'application/json'}\r\n                })\r\n                .then(res => res.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    this.setState({\r\n                        views: 0,\r\n                    })\r\n                    })\r\n                .catch(err => console.log(err))\r\n            }\r\n            if(val.includes(\"entries\")){\r\n                fetch('/orders/reset/entries', {\r\n                    method: \"put\", \r\n                    headers: {'Content-Type': 'application/json'}\r\n                })\r\n                .then(res => res.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    this.setState({\r\n                        entries: 0,\r\n                        orders: [],\r\n                        all: [],\r\n                        trash: [],\r\n                        active: []\r\n                    })\r\n                })\r\n                .catch(err => console.log(err))\r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    handlePaging = (e) => {\r\n        const number = Number(e.target.innerText)\r\n        if(number !== this.state.page){\r\n            const  orders = [...this.state.active];\r\n            if(number === 1){\r\n                this.setState({\r\n                    orders: orders.slice(0, this.entriesByPage),\r\n                    page: 1\r\n                })\r\n                return;\r\n            }else{\r\n                const start = this.entriesByPage * (number - 1);\r\n                const order = (start+this.entriesByPage) > orders.length ? orders.splice(start) : orders.splice(start, this.entriesByPage) \r\n                \r\n                this.setState({\r\n                    orders: order,\r\n                    page: number\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    render() { \r\n        const orders = !this.state.orders.length ? (<p className=\"no-orders red-text\">{this.state.isFiltered? \"No Order Found\" : \"No Orders Yet\"}</p>) : (\r\n            this.state.orders.map((order, index) => {\r\n                    let className = index % 2 === 0 ? \"classone\" : \"classtwo\";\r\n                return (\r\n                   <Order order={order} delete={this.delete} trash={this.trash} key={order.id} class={className} filter={this.state.filter} toggleRead={this.toggleRead} restore={this.restore}/>\r\n                )\r\n            })\r\n        )\r\n        const pageNo = Math.ceil(this.state.active.length / this.entriesByPage);\r\n        const pages = []\r\n        for(var x = 1; x <= pageNo; x++){\r\n            let active = x === this.state.page ? \" active\" : \" inactive\";\r\n            let html = (<span className={\"page\" + active} key={x} onClick={this.handlePaging}>{x.toString()}</span>)\r\n            pages.push(html);\r\n        }\r\n        return ( \r\n        <div className=\"admins\">\r\n            <div className=\"header\">\r\n            <span>Views: {this.state.views}<i onClick={this.reset}>reset views</i></span>\r\n            <span>Entries: {this.state.entries}<i onClick={this.reset} >reset entries</i></span>\r\n            </div>\r\n            <div className=\"search-form\" ><form><input type=\"text\" name=\"search\" placeholder=\"search text\" onChange={this.handleChange} /><input type=\"submit\" value=\"Search\" onClick={this.handleSubmit}/></form></div>\r\n            <div className=\"filter\"><span onClick={this.filter} className ={this.state.filter === 1 ? \"active\" : \"inactive\"} >All<i>{this.state.all.length}</i></span>\r\n                <span onClick={this.filter} className ={this.state.filter === 2 ? \"active\" : \"inactive\"}>Unread<i>{this.state.unread}</i></span>\r\n\r\n                <span onClick={this.filter} className ={this.state.filter === 3 ? \"active\" : \"inactive\"}>Trash<i>{this.state.trash.length}</i></span></div>\r\n            <div className=\"orders\">\r\n                {orders}\r\n            </div>\r\n            { this.state.active.length > this.entriesByPage \r\n            ?  (<div className=\"paging\"><div className=\"pages\">{pages}</div></div>)\r\n            : \"\" }\r\n        </div> \r\n        );\r\n    }\r\n}\r\n \r\nexport default Orders;"]},"metadata":{},"sourceType":"module"}